---
hidden: true
title: "차원 기반 집계 (Dimension-Based Aggregation)"
description: "Notifly가 사용자 및 디바이스 속성별로 통계를 분류하는 방법."
---

## 개요

차원을 사용하면 사용자 특성별로 그룹화된 Campaign 통계를 볼 수 있습니다. "1,000개 발송" 대신 "iOS 사용자에게 500개 발송, Android 사용자에게 500개 발송"을 볼 수 있습니다.

## 차원 작동 방식

### 차원 없이

| 지표 | 값 |
|------|-----|
| send_success | 1,000 |
| push_click | 150 |

### 플랫폼 차원 포함

| 지표 | 플랫폼 | 값 |
|------|--------|-----|
| send_success | (전체) | 1,000 |
| send_success | iOS | 500 |
| send_success | Android | 500 |
| push_click | (전체) | 150 |
| push_click | iOS | 90 |
| push_click | Android | 60 |

## 지원되는 차원 소스

### 사용자 속성

추적하는 모든 커스텀 사용자 속성을 차원으로 사용할 수 있습니다.

| 소스 | 저장 방식 |
|------|-----------|
| 커스텀 속성 | 데이터베이스에 암호화되어 저장, 집계 중 복호화 |
| 예시 | `region`, `subscription_tier`, `age_group`, `language` |

### 디바이스 속성

사용자 디바이스의 표준 속성.

| 속성 | 예시 값 |
|------|---------|
| `platform` | `iOS`, `Android`, `Web` |
| `app_version` | `1.0.0`, `2.3.1` |
| `os_version` | `iOS 17.0`, `Android 14` |
| `sdk_version` | `1.0.0`, `2.0.0` |

## 집계가 차원을 처리하는 방법

### 1단계: 사용자 속성 가져오기

각 이벤트에 대해 사용자의 속성을 조회합니다:
- 사용자 ID → 사용자 속성 테이블
- 암호화된 값 복호화

### 2단계: 디바이스 속성 가져오기

디바이스 차원이 필요한 경우:
- 사용자는 여러 디바이스를 가질 수 있음
- 가장 최근에 업데이트된 디바이스 선택 (`updated_at`)
- 해당 디바이스의 속성 사용

### 3단계: 출력 행 생성

각 지표에 대해 여러 행 생성:
- **전체**를 위한 한 행 (빈 차원 값)
- **각 차원 값**에 대해 한 행씩

### 예시

이벤트: `region=Seoul`, `platform=iOS`인 사용자의 `push_click`

출력 행:
| 지표 | 차원 키 | 차원 값 | 횟수 |
|------|---------|---------|------|
| push_click | (빈 값) | (빈 값) | 1 |
| push_click | region | Seoul | 1 |
| push_click | platform | iOS | 1 |

## 디바이스 중복 제거

사용자는 종종 여러 디바이스를 가집니다. 디바이스 속성을 조회할 때:

### 문제

| 사용자 | 디바이스 | 플랫폼 | 업데이트 |
|--------|----------|--------|----------|
| user123 | device_A | iOS | 1월 15일 |
| user123 | device_B | Android | 1월 20일 |

user123에 어떤 플랫폼을 사용해야 할까요?

### 해결책

가장 최근에 업데이트된 디바이스 사용:
- `updated_at` 기준 내림차순 정렬
- 첫 번째(가장 최근) 선택
- 사용자별로 `ROW_NUMBER()` 파티션 사용

결과: user123 → Android (device_B, 1월 20일 업데이트)

## 집계 출력 형식

### 필드

| 필드 | 설명 | 예시 |
|------|------|------|
| `dimension_key` | 속성 이름 | `region`, `platform` |
| `dimension_value` | 속성 값 | `Seoul`, `iOS` |
| `metric_name` | 이벤트 유형 | `send_success` |
| `value` | 횟수 또는 합계 | `500` |

### 빈 차원 = 전체

`dimension_key`와 `dimension_value`가 빈 문자열인 경우:
- 이것은 모든 차원 값에 대한 **전체**
- 항상 모든 지표에 포함됨

## 일반적인 사용 사례

### 지역별

가장 많이 참여하는 지역 확인:
- 차원: `region` (사용자 속성)
- 지표: `push_click`, `email_open`

### 플랫폼별

iOS vs. Android 비교:
- 차원: `platform` (디바이스 속성)
- 지표: `send_success`, `push_click`

### 구독 등급별

무료 vs. 유료 사용자 비교:
- 차원: `subscription_tier` (사용자 속성)
- 지표: 전환, 참여

### 앱 버전별

새 버전 채택 추적:
- 차원: `app_version` (디바이스 속성)
- 지표: `send_success`, `send_failure`

## 제한 사항

### 모든 조합 불가

차원은 개별적으로 처리되며, 조합으로는 처리되지 않습니다:
- 지원됨: 지역별, 플랫폼별 (별도로)
- 지원되지 않음: 지역 AND 플랫폼별 (조합)

### 속성이 존재해야 함

사용자에게 차원 속성이 없는 경우:
- **전체**에는 포함됨
- 어떤 차원 값 행에도 포함되지 않음

### 디바이스 속성 타이밍

디바이스 속성은 집계 시점의 **가장 최근 디바이스**를 반영합니다:
- 사용자가 iOS에서 Android로 전환
- 향후 통계는 Android로 표시됨
- 과거 통계는 소급하여 변경되지 않음

## 관련 문서

- [집계 개요](/ko/knowledge-base/campaigns/aggregation/index) - 집계 작동 방식
- [메시지 이벤트](/ko/knowledge-base/campaigns/aggregation/message-events) - 추적되는 이벤트
- [전환 추적](/ko/knowledge-base/campaigns/aggregation/conversion-tracking) - 전환 지표
- [사용자와 디바이스](/ko/knowledge-base/concepts/users-and-devices) - 사용자 속성 개념
