---
hidden: true
title: "이메일 (Email)"
description: "이메일은 사용자의 이메일 받은편지함에 메시지를 보냅니다."
---

## 개요

이메일은 사용자에게 연락하는 가장 일반적인 방법 중 하나입니다. 긴 콘텐츠, 영수증, 뉴스레터, 나중에 참조해야 하는 메시지에 적합합니다.

## 작동 방식

1. 사용자가 이메일 주소를 제공합니다
2. 제목과 내용으로 이메일을 작성합니다
3. Notifly가 이메일 서비스(AWS SES 등)를 통해 발송합니다
4. 이메일이 사용자의 받은편지함에 도착합니다

## 요구 사항

- 사용자의 유효한 이메일 주소
- Notifly에 발신자 이메일 구성

## 메시지 콘텐츠

| 필드 | 설명 | 필수 |
|-------|-------------|----------|
| Sender | 이메일 발신자 | 예 |
| Sender name | 발신자 표시 이름 | 아니오 |
| Subject | 이메일 제목 | 예 |
| Body HTML | 리치 HTML 콘텐츠 | 예 (또는 텍스트) |
| Body Text | 일반 텍스트 버전 | 아니오 |

## 이메일 유형

| 유형 | 설명 |
|------|-------------|
| HTML 이메일 | 리치 포맷팅, 이미지, 링크 |
| 템플릿 기반 | 사전 제작된 이메일 템플릿 사용 |
| 일반 텍스트 | 단순 텍스트 전용 이메일 |

## 개인화

이메일은 [Liquid 템플릿](/ko/knowledge-base/concepts/liquid-templates) 개인화를 전체 지원합니다.

**지원되는 필드:**
- 제목
- 본문 (HTML 및 일반 텍스트)

**예시:**
```liquid
Subject: {{user.$name | default: "고객"}}님, 주문이 확정되었습니다!

Body:
안녕하세요 {{user.$name}}님,
주문번호 #{{event.order_id}} {{event.product_name}}이 확정되었습니다.
```

**보안 참고:** Liquid 변수의 HTML 콘텐츠는 XSS 공격을 방지하기 위해 자동으로 이스케이프됩니다. 예를 들어, `<script>`는 `&lt;script&gt;`가 됩니다.

## 규칙

- 사용자가 유효한 이메일 주소를 가지고 있어야 함
- 이메일은 스팸 방지법을 준수해야 함 (수신 거부 포함)
- [피로도 관리](/ko/knowledge-base/rules/fatigue-management) 적용
- [제외 사용자](/ko/knowledge-base/rules/excluded-users)에서 비활성화 가능
- 이메일 제공업체의 발송 속도 제한 고려
- [서킷 브레이커](#서킷-브레이커)가 높은 반송률의 campaign을 자동 종료할 수 있음

## 예외 사항

- 유효하지 않은 이메일 주소는 발송 실패 유발
- 반송된 이메일은 주소를 무효로 표시할 수 있음
- 일부 이메일은 스팸 폴더로 이동

## 서킷 브레이커

> 이메일 반송이 너무 많을 때 campaign을 자동으로 중지하는 안전 시스템입니다.

### 개요

이메일을 보내면 일부는 "반송"(발송 실패)됩니다. 너무 많은 이메일이 반송되면 이메일 제공업체에서 발신자 평판이 손상될 수 있습니다. 서킷 브레이커는 이를 감시하고 피해가 발생하기 전에 campaign을 중지합니다.

### 계산 방법

서킷 브레이커는 두 가지를 확인합니다:

1. **Campaign 반송률** - 발송 대비 반송 수
   - 공식: `반송 수 ÷ 발송 수`
   - 임계값: **5% 이상**이면 확인 트리거

2. **AWS SES 계정 반송률** - 전체 이메일 평판 (최근 1시간)
   - 임계값: **3% 초과**면 문제 확인

두 조건이 모두 참이어야 서킷 브레이커가 작동합니다.

### 활성화 요구 사항

| 조건 | 값 | 이유 |
|-----------|-------|-----|
| 최소 발송 수 | 1,000+ | 소량 발송의 오경보 방지 |
| Campaign 반송률 | ≥ 5% | Campaign에 문제 있음 |
| SES 계정 반송률 | > 3% | 계정 평판 위험 |
| Campaign 상태 | Active | 이미 중지된 campaign 미적용 |
| Campaign 유형 | Scheduled | 이벤트 기반 campaign 제외 |

### 반송으로 간주되는 것

| 반송 유형 | 카운트 여부 | 예시 |
|-------------|----------|---------|
| 영구 (하드 바운스) | 예 | 이메일 주소가 존재하지 않음 |
| 일시 (하드) | 예 | 서버가 이메일을 거부함 |
| 거부 | 예 | AWS SES가 발송 거부 |
| 임시 (소프트 바운스) | 아니오 | 메일박스 가득 참, 나중에 재시도 |

임시 반송(일시적 문제)은 스스로 해결되는 경우가 많아 무시됩니다.

### 작동 시 발생하는 일

서킷 브레이커가 활성화되면:

1. **Campaign 종료** - 상태가 terminated (상태 3)로 변경
2. **더 이상 이메일 발송 안 됨** - Campaign이 즉시 중지
3. **반송된 사용자 제외** - 반송을 유발한 사용자가 다시는 이메일을 받지 않도록 표시됨

### 사용자 제외

이메일이 반송되면 해당 사용자가 [제외 사용자](/ko/knowledge-base/rules/excluded-users) 목록에 추가됩니다:
- 채널: 이메일만 (다른 채널은 계속 작동)
- 설명: "SES Bounce"
- 효과: 이 주소로 향후 이메일 발송 안 됨

### 이벤트 기반 campaign이 제외되는 이유

이벤트 기반 campaign(사용자 행동으로 트리거)은 자동 종료되지 않습니다:
- 한 번에 한 사용자에게 발송
- 높은 반송률이 소량 샘플 때문일 수 있음
- 중지하면 중요한 트랜잭션 이메일이 중단될 수 있음

### 데이터 추적

| 지표 | 저장 위치 | 보관 기간 |
|--------|--------------|---------------|
| Campaign당 발송 수 | Redis | 7일 |
| Campaign당 반송 수 | Redis | 7일 |
| SES 계정 반송률 | AWS에서 캐시 | 5분 |

## 문제 해결

### 일반적인 발송 문제

| 증상 | 원인 | 해결책 |
|---------|-------|----------|
| 하드 바운스 | 이메일 존재하지 않음 | 목록에서 제거 |
| 소프트 바운스 | 메일박스 가득 참 | 나중에 재시도 |
| 스팸으로 분류됨 | 발신자 평판 저하 | 인증 개선 (SPF/DKIM) |
| 수신 안 됨 | 스팸 폴더 확인 | 발송 상태 확인 |

### 디버깅 체크리스트

- [ ] 사용자에게 유효한 이메일 주소가 있나요?
- [ ] 발신자 이메일이 확인되었나요?
- [ ] SPF/DKIM/DMARC가 구성되었나요?
- [ ] 로그에서 반송 유형 확인했나요?

**전체 문제 해결 가이드:** [이메일 실패](/ko/knowledge-base/troubleshooting/channel-failures/email)

## 관련 문서

- [SMS](/ko/knowledge-base/channels/sms) - 문자 메시지
- [Liquid 템플릿](/ko/knowledge-base/concepts/liquid-templates) - 개인화 기능
- [채널](/ko/knowledge-base/channels/index) - 모든 채널
- [Campaign](/ko/knowledge-base/concepts/campaigns) - Campaign에서 이메일 사용
- [제외 사용자](/ko/knowledge-base/rules/excluded-users) - 메시지 수신 차단된 사용자
- [이메일 문제 해결](/ko/knowledge-base/troubleshooting/channel-failures/email) - 발송 문제
