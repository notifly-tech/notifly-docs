---
hidden: true
title: "User Journey 통계 집계 (User Journey Statistics Aggregation)"
description: "Notifly가 User Journey의 각 단계에서 성과를 추적하는 방법."
---

## 개요

User Journey 통계는 Journey의 각 노드가 얼마나 잘 수행되고 있는지 보여줍니다. 환영 Journey의 경우, 몇 명의 사용자가 메시지 1을 받았는지, 몇 명이 클릭했는지, 몇 명이 메시지 2로 계속했는지 볼 수 있습니다.

## Campaign 통계와의 차이점

| 측면 | Campaign 통계 | Journey 통계 |
|------|---------------|--------------|
| 그룹화 | Campaign + 변형별 | Journey + 노드별 |
| 범위 | 단일 Campaign | 전체 Journey 흐름 |
| 사용 사례 | A/B 테스트 | 흐름 최적화 |

## 추적되는 것

각 Journey 노드는 다음을 가질 수 있습니다:

### 메시지 지표

[Campaign 메시지 이벤트](/ko/knowledge-base/campaigns/aggregation/message-events)와 동일:
- `send_success` - 메시지 발송됨
- `send_failure` - 발송 실패
- `push_click` - 푸시 알림 탭됨
- `email_open` - 이메일 열림
- `in_app_message_show` - 인앱 메시지 표시됨
- 그리고 더...

### 전환 지표

[Campaign 전환](/ko/knowledge-base/campaigns/aggregation/conversion-tracking)과 동일:
- `total_count_conversion` - 모든 수신자의 전환
- `direct_count_conversion` - 참여한 사용자의 전환
- `sales_conversion` - 총 판매 금액

## 작동 방식

### 처리 단계

1. **메시지 이벤트 추출** - `user_journey_id`와 `user_journey_node_id`로 필터링
2. **사전 전환 이벤트 추출** - 어떤 노드에서 누가 메시지를 받았는지 추적
3. **전환 이벤트 매칭** - 전환을 특정 노드에 연결
4. **노드별 집계** - 각 Journey 노드의 지표 합산

### 주요 식별자

| 필드 | 목적 |
|------|------|
| `user_journey_id` | 어떤 Journey |
| `user_journey_node_id` | Journey의 어떤 단계 |
| `campaign_id` | 해당 노드의 메시지 Campaign |
| `variant_id` | A/B 변형 (Journey 내 테스트 시) |

## 출력 테이블

Journey 통계는 `user_journey_statistics` 테이블로 이동합니다.

### 필드

| 필드 | 설명 |
|------|------|
| `user_journey_id` | Journey 식별자 |
| `user_journey_node_id` | 노드 식별자 |
| `metric_name` | 이벤트 유형 (send_success, push_click 등) |
| `metric_type` | `message_event` 또는 `conversion` |
| `conversion_type` | `TOTAL` 또는 `DIRECT` (전환용) |
| `value` | 횟수 또는 합계 |
| `collected_from` | 시간 버킷 시작 |
| `collected_to` | 시간 버킷 종료 |

## 대규모 프로젝트 처리

일부 프로젝트는 매우 큰 Journey나 높은 볼륨을 가집니다. 이들은 특별한 처리를 받습니다:

### 시간 청킹

모든 데이터를 한 번에 처리하는 대신:
- 시간 범위를 **1시간 배치**로 분할
- 각 배치를 별도로 처리
- 메모리 문제 방지

### 배치 크기

- **표준**: 모든 Journey를 함께 처리
- **대규모 프로젝트**: **작업당 10개 Journey**
- 타임아웃 문제 방지

### 추가 리소스

대규모 프로젝트는 다음을 사용할 수 있습니다:
- G.2X 인스턴스 (더 많은 메모리)
- 4개 워커 (병렬 처리)

### 어떤 프로젝트?

특정 고용량 프로젝트가 이 처리를 위해 구성됩니다. 프로젝트에 지속적으로 문제가 있으면 엔지니어링 팀이 목록에 추가할 수 있습니다.

## Journey 특정 로직

### 노드 컨텍스트

각 이벤트는 Journey 컨텍스트와 함께 태그됩니다:
- 사용자가 있는 Journey
- 메시지를 트리거한 노드
- Journey 진행 상황

### 전환 기여

전환은 사용자가 통과한 **마지막 메시지 노드**에 기여됩니다:
- 사용자가 Journey에 진입
- 노드 A 통과 (메시지)
- 노드 B 통과 (대기)
- 노드 C 통과 (메시지)
- 구매함
- 구매가 **노드 C**에 기여됨

## 예시

3개의 메시지 노드가 있는 환영 Journey:

| 노드 | 유형 | 일차 |
|------|------|------|
| 노드 1 | 환영 이메일 | 0일차 |
| 노드 2 | 기능 소개 푸시 | 3일차 |
| 노드 3 | 업그레이드 제안 이메일 | 7일차 |

통계는 다음과 같이 표시될 수 있습니다:

| 노드 | send_success | email_open | push_click | 전환 |
|------|--------------|------------|------------|------|
| 노드 1 | 1,000 | 450 | - | 20 |
| 노드 2 | 950 | - | 200 | 35 |
| 노드 3 | 900 | 300 | - | 80 |

이것이 알려주는 것:
- 노드 1과 2 사이에 50명의 사용자가 떠남
- 노드 2는 좋은 푸시 참여율을 가짐
- 노드 3이 가장 많은 전환을 이끔

## 타이밍

- **매시간** 실행 (Campaign 통계와 동일)
- 대규모 Journey의 경우 처리가 더 오래 걸릴 수 있음
- `lastCollectedAt`이 완료 시간을 표시

## 관련 문서

- [집계 개요](/ko/knowledge-base/campaigns/aggregation/index) - 집계 작동 방식
- [User Journey](/ko/knowledge-base/journeys/index) - Journey가 무엇인지
- [메시지 이벤트](/ko/knowledge-base/campaigns/aggregation/message-events) - 이벤트 유형
- [전환 추적](/ko/knowledge-base/campaigns/aggregation/conversion-tracking) - 전환 로직
