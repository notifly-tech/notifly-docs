---
hidden: true
title: "Push Notification Failures (푸시 알림 장애)"
description: "푸시 알림이 실패하는 이유와 해결 방법입니다."
---

## 빠른 참조

| 증상 | 가능한 원인 | 해결책 |
|------|------------|--------|
| 토큰 없음 | 사용자가 권한 허용 안함 | 사용자가 알림 활성화 필요 |
| 잘못된 토큰 | 토큰 만료 또는 앱 삭제됨 | 무효 토큰 제거, 재등록 |
| 미등록 | 앱 삭제됨 | 토큰 정리 |
| 잘못된 자격증명 | APNs/FCM 설정 오류 | 프로젝트 자격증명 확인 |
| 속도 제한됨 | 메시지가 너무 빠르게 발송됨 | 발송 속도 줄이기 |

---

## 일반적인 장애

### 잘못된 디바이스 토큰

**의미:** 이 사용자에게 저장된 토큰이 더 이상 유효하지 않습니다.

**발생 이유:**
- 사용자가 앱 삭제
- 사용자가 앱 재설치 (새 토큰)
- 토큰 만료 (드뭄)
- 토큰이 잘못된 환경용 (sandbox vs production)

**확인 방법:**
- 발송 상태에 "Invalid" 또는 "Unregistered" 표시
- 토큰 형식은 맞지만 발송 실패

**해결 방법:**
- 사용자 프로필에서 토큰을 무효로 표시
- 다음 앱 실행 시 앱이 재등록하고 새 토큰 전송해야 함
- SDK가 토큰 갱신을 제대로 처리하는지 확인

---

### 디바이스 토큰 없음

**의미:** 사용자 프로필에 푸시 토큰이 없습니다.

**발생 이유:**
- 사용자가 앱을 열지 않음
- 사용자가 알림 권한 거부
- SDK가 토큰을 Notifly로 제대로 전송 안함
- 토큰 등록 전 앱 충돌

**확인 방법:**
- 사용자 프로필 조회
- 디바이스 섹션에 푸시 토큰 없음

**해결 방법:**
- 사용자가 앱 열고 권한 허용 필요
- SDK 연동이 토큰을 올바르게 전송하는지 확인
- 앱의 권한 요청 흐름 확인

---

### 권한 거부됨

**의미:** 사용자가 앱 알림을 비활성화했습니다.

**iOS 동작:**
- 권한 프롬프트에서 "허용 안함" 탭한 경우
- 설정 > 알림에서 비활성화한 경우

**Android 동작:**
- 앱 설정에서 비활성화 가능
- 일부 Android 버전은 권한 요청

**확인 방법:**
- 발송 시도에 "Permission denied" 표시
- 토큰은 있지만 알림이 나타나지 않음

**해결 방법:**
- 사용자가 디바이스 설정에서 수동으로 활성화해야 함
- 앱이 설정으로 이동하도록 안내 가능
- 대안으로 인앱 메시지 고려

---

### 잘못된 환경

**의미:** 토큰은 sandbox용이지만 production으로 발송 (또는 반대).

**발생 시점:**
- 개발 빌드로 테스트 후 production에서 발송
- APNs sandbox vs production 불일치

**확인 방법:**
- 테스트에서는 작동, production에서 실패
- 오류에 "invalid token" 또는 "BadDeviceToken" 언급

**해결 방법:**
- 앱 환경이 인증서와 일치하는지 확인
- 올바른 APNs 인증서 사용 (dev vs prod)
- 올바른 설정으로 앱 재빌드

---

### 자격증명 오류

**의미:** 프로젝트 설정의 푸시 자격증명이 잘못되었거나 만료되었습니다.

**APNs (iOS) 문제:**
- 인증서 만료
- 잘못된 인증서 업로드
- 인증서가 앱 번들 ID와 일치하지 않음

**FCM (Android) 문제:**
- 잘못된 서버 키
- 프로젝트 불일치
- 키 취소됨

**확인 방법:**
- 모든 푸시 알림 실패, 한 사용자만이 아님
- 오류에 "authentication" 또는 "invalid credentials" 언급

**해결 방법:**
1. 프로젝트 설정 > 푸시 설정으로 이동
2. 유효한 자격증명 재업로드
3. APNs: Apple Developer에서 새 인증서 생성
4. FCM: Firebase Console에서 새 서버 키 받기

---

### 속도 제한

**의미:** 메시지가 너무 빠르게 너무 많이 발송되었습니다.

**발생 시점:**
- 대형 campaign을 한 번에 발송
- 여러 campaign이 동시에 실행

**확인 방법:**
- 일부 메시지 성공, 일부 실패
- 오류에 "rate limit" 또는 "too many requests" 언급

**해결 방법:**
- 배치 크기 줄이기
- 대량 발송 분산
- 가능한 경우 throttling 설정 사용

---

## iOS 특정 문제

### APNs 인증서 만료

**증상:** 모든 iOS 사용자에게 푸시가 갑자기 작동 중지

**확인:**
- 인증서는 언제 만료되나?
- 인증서가 최근 갱신되었나?

**해결:**
1. Apple Developer 포털에서 새 APNs 인증서 생성
2. Notifly 프로젝트 설정에 업로드
3. 즉시 테스트

---

### 임시 권한

**개념:** iOS 12+는 알림 센터에 전달되지만 알림하지 않는 "임시" 알림 허용.

**증상:** 토큰 있음, 발송 성공, 하지만 사용자가 알림을 보지 못함.

**설명:** 알림이 전달되었지만 조용히 표시됨.

**해결:** 사용자가 알림에 참여해야 전체 권한으로 업그레이드됨.

---

### 백그라운드 앱 새로고침 비활성화

**증상:** 앱이 백그라운드일 때 알림이 나타나지 않음.

**확인:** 앱이 열려 있을 때 알림이 나타나나?

**해결:** 사용자가 디바이스 설정에서 백그라운드 앱 새로고침 활성화해야 함.

---

## Android 특정 문제

### FCM 토큰 갱신

**상황:** FCM 토큰은 언제든지 갱신될 수 있음.

**증상:** 이전에는 푸시가 작동했는데, 이제 특정 사용자에게 실패.

**해결:** 앱이 `onNewToken` 콜백을 처리하고 새 토큰을 Notifly에 전송하는지 확인.

---

### 알림 채널 (Android 8+)

**개념:** Android 8+는 알림 채널 필요.

**증상:** 토큰 유효, 발송 성공, 알림 보이지 않음.

**확인:** 앱에서 알림 채널이 생성되었나?

**해결:** 앱이 첫 알림 전에 알림 채널을 생성해야 함.

---

### 배터리 최적화

**개념:** Android가 배터리 최적화된 앱의 알림을 차단할 수 있음.

**증상:** 간헐적 전달, 특히 폰이 유휴 상태일 때.

**확인:** 앱이 배터리 최적화에서 제외되었나?

**해결:** 사용자가 앱의 배터리 최적화를 비활성화해야 함.

---

### 제조사 커스터마이징

일부 Android 제조사 (Xiaomi, Huawei, Oppo 등)는 공격적인 배터리 관리 기능이 있음.

**증상:** 알림이 도착하지 않거나 심하게 지연됨.

**해결:**
- 사용자가 제조사 배터리 설정에서 앱을 화이트리스트에 추가해야 함
- 제조사마다 다름
- "[제조사명] 앱 알림 문제" 검색

---

## 디버깅 체크리스트

### 발송 전

- [ ] 사용자 프로필에 디바이스 토큰이 있는가?
- [ ] 토큰이 올바른 플랫폼용 (iOS/Android)인가?
- [ ] 토큰이 무효로 표시되지 않았는가?
- [ ] 프로젝트에 푸시 자격증명 설정되었는가?
- [ ] 자격증명이 만료되지 않았는가?

### 실패 후

- [ ] 발송 로그에 어떤 오류 메시지가 있는가?
- [ ] 한 사용자인가 모든 사용자인가?
- [ ] 이전에 작동했는가? 무엇이 변경되었는가?
- [ ] 사용자 디바이스에 앱이 여전히 설치되어 있는가?
- [ ] 디바이스 알림 설정 확인

---

## 오류 메시지 참조

| 오류 | 의미 | 조치 |
|------|------|------|
| InvalidToken | 토큰 형식 오류 또는 만료 | 제거하고 재등록 |
| Unregistered | 앱 삭제됨 | 토큰 정리 |
| BadDeviceToken | 이 환경에서 토큰 무효 | 환경 확인 (sandbox/prod) |
| ExpiredProviderToken | APNs 인증 토큰 만료 | 자격증명 갱신 |
| InvalidProviderToken | APNs 인증 무효 | 인증서 확인 |
| MissingDeviceToken | 요청에 토큰 없음 | 사용자 프로필 확인 |
| NotRegistered | FCM 토큰 미등록 | 토큰 갱신 필요 |
| InvalidRegistration | FCM 토큰 무효 | 디바이스 재등록 |
| MismatchSenderId | FCM 발신자 ID 잘못됨 | FCM 설정 확인 |

---

## 관련 문서

- [푸시 알림](/ko/knowledge-base/channels/push-notification) - 채널 개요
- [사용자와 디바이스](/ko/knowledge-base/concepts/users-and-devices) - 디바이스 토큰
- [채널 장애 인덱스](/ko/knowledge-base/troubleshooting/channel-failures/index) - 모든 채널 장애
- [메시지가 발송되지 않음](/ko/knowledge-base/troubleshooting/message-not-sending) - 일반 문제 해결

---
*이 가이드로 푸시 알림 발송 실패를 진단하세요.*
